<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="utf-8">
</head>
<body>
	<ul id="list"></ul>
	<script src="jquery.min.js"></script>
	<script src="hmac-sha1.js"></script>
	<script src="backbeam.js"></script>
	<script>
		backbeam.configure({ project:'callezeta', env:'dev', realtime:true }, function(err) {
			backbeam.setEventHandler(function(data) {
				console.log('received', data)
			})

			backbeam.subscribeToEvents('foo')

			backbeam.sendEvent('foo', {say:'hello world!'})
			console.log('message sent')
		})
		backbeam.select('file').fetch(100, 0, function(error, objects) {
			$.each(objects, function(i, obj) {
				var li = $('<li></li>').text(obj.get('name'))
				$('#list').append(li)
				var images = obj.get('images').result
				if (images && images.length > 0) {
					var first = images[0]
					var url = first.fileURL({width:44, height:44})
					li.prepend($('<img>').attr('src', url))
				}
			})
		})

		var hash = CryptoJS.HmacSHA1("Message", "Secret Passphrase");
		console.log('hash', hash.toString(CryptoJS.enc.Hex))

		// var e = client.empty('event')
		// e.set('name', 'A new event')
		// e.insert(function(err, foo) {
		// 	e.set('name', 'An updated event')
		// 	e.update(function(err, foo) {
		// 		e.remove(function(err, foo) {
		// 			console.log('inserted, updated and finally... deleted')
		// 		})
		// 	})
		// })
	</script>
</body>
